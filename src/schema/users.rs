//! `SeaORM` Entity. Generated by sea-orm-codegen 0.11.3

use async_graphql::SimpleObject;
use sea_orm::entity::prelude::*;
use serde::{Deserialize, Serialize};

use crate::guards::scope::ScopeGuard;

#[derive(Clone, Debug, PartialEq, DeriveEntityModel, Eq, SimpleObject, Deserialize, Serialize)]
#[sea_orm(table_name = "users")]
#[graphql(
    concrete(name = "User", params()),
    complex,
    rename_fields = "snake_case",
    rename_args = "snake_case"
)]
pub struct Model {
    #[sea_orm(primary_key, auto_increment = false)]
    pub id: Uuid,
    #[graphql(guard = "ScopeGuard::new(\"profile:read:email\")")]
    pub email: String,
    #[serde(with = "chrono::serde::ts_milliseconds")]
    #[graphql(guard = "ScopeGuard::new(\"profile:read:joined\")")]
    pub joined: chrono::DateTime<chrono::Utc>,
    #[graphql(skip)]
    pub password: String,
    #[graphql(guard = "ScopeGuard::new(\"profile:read:name\")")]
    pub first_name: String,
    #[graphql(guard = "ScopeGuard::new(\"profile:read:name\")")]
    pub last_name: String,
    #[graphql(guard = "ScopeGuard::new(\"profile:read:phone_number\")")]
    pub calling_code: String,
    #[graphql(guard = "ScopeGuard::new(\"profile:read:phone_number\")")]
    pub country_code: String,
    #[graphql(guard = "ScopeGuard::new(\"profile:read:phone_number\")")]
    pub phone_number: String,
    #[graphql(guard = "ScopeGuard::new(\"profile:read:roles\")")]
    pub role: Option<String>,
    #[graphql(skip)]
    pub referrer: Option<Uuid>,
    #[graphql(skip)]
    pub stripe_customer_id: Option<String>,
}

#[derive(Copy, Clone, Debug, EnumIter, DeriveRelation)]
pub enum Relation {
    #[sea_orm(has_many = "super::question_assessments::Entity")]
    QuestionAssessments,
    #[sea_orm(has_many = "super::unit_progress::Entity")]
    UnitProgress,
}

impl Related<super::question_assessments::Entity> for Entity {
    fn to() -> RelationDef {
        Relation::QuestionAssessments.def()
    }
}

impl Related<super::unit_progress::Entity> for Entity {
    fn to() -> RelationDef {
        Relation::UnitProgress.def()
    }
}

impl ActiveModelBehavior for ActiveModel {}
